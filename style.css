this modified by shor branch
anew branch modified
